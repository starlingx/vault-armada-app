From 3a687b597f91a7f344a22d5f63b24159880ee74f Mon Sep 17 00:00:00 2001
From: Greg Waines <greg.waines@windriver.com>
Date: Sat, 5 Nov 2022 20:14:58 -0400
Subject: [PATCH] Add vault manager repository to values.yaml

---
 values.yaml | 37 +++++++++++++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)

diff --git a/values.yaml b/values.yaml
index 61af7b2..aff058b 100644
--- a/values.yaml
+++ b/values.yaml
@@ -24,6 +24,43 @@ global:
       seccomp.security.alpha.kubernetes.io/defaultProfileName:  runtime/default
       apparmor.security.beta.kubernetes.io/defaultProfileName:  runtime/default
 
+manager:
+  image:
+    repository: starlingx/stx-vault-manager
+    tag: stx.9.0-v1.24.4
+
+  # Rate at which vault-manager checks status of vault servers.
+  # After initialization of the raft, Vault manager will loop forever
+  # checking the pods for vault servers that need to be unsealed.
+  # This value is the sleep, in seconds, between intervals.  Value
+  # must be a positive integer
+  statusCheckRate: 5
+
+  # After initial configuration, in combination with statusCheckRate,
+  # the amount of time to wait before unsealing a recovering vault
+  # server.  The option is intended to allow the active vault server
+  # time to start sending heartbeats to the recovering pod before
+  # unsealing the server.
+  #
+  # A value of 0 indicates no wait time: unseal the vault server without
+  # delay.  The wait time is statusCheckRate * unsealWaitIntervals.
+  # Default is 5 s/interval * 3 intervals == 15 seconds.
+  #
+  unsealWaitIntervals: 3
+
+  # Network timeout for queries to vault server /sys/health endpoint
+  #
+  # The maximum time in seconds to wait for a server to respond to
+  # health query.  This applies for the HA recovery situations, not the
+  # initialization of vault cluster.  Unsetting the value is not
+  # recommended, and defaults to curl --connect-timeout of 60 seconds.
+  #
+  # vault-manager will appear to hang if healthQueryTimeout is
+  # over-large.  This setting affects the logs, since vault-manager will
+  # issue a log when the 'sealed' status toggles between true/false and
+  # the 'unknown' value
+  healthQueryTimeout: 2
+
 injector:
   # True if you want to enable vault agent injection.
   enabled: true
-- 
2.25.1

